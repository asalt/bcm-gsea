---
title: "run.Rmd"
author: "BCM MSPC"
date: '`r Sys.Date()`'
output: html_document
params:
  volcanodir: none
  rankfiledir: none
  species: "Homo sapiens"
  genesets_json: >
    [
      {"category": "H", "subcategory": ""},
      {"category": "C2", "subcategory": "CP:KEGG"},
      {"category": "C2", "subcategory": "CP:REACTOME"},
      {"category": "C5", "subcategory": "GO:MF"},
      {"category": "C5", "subcategory": "GO:BP"},
      {"category": "C5", "subcategory": "GO:CP"}
      /* {"category": "C2", "subcategory": "CP:KEGG"}
      */
    ]
  
---

# setup

```{r}

params$genesets_json
json_data <- jsonlite::parse_json(params$genesets_json)
#SPECIES <- "Homo sapiens" # or "Mus musculus" or Saccharomyces cerevisiae, and others
#params$species
```



```{r setup, include=FALSE}
library(purrr) # for map()
library(magrittr)
library(ggplot2)
library(fs) # for dir_ls()
library(fgsea)
library(dplyr)
library(msigdbr)
library(stringr)
library(readr)
library(tidyr)
knitr::opts_chunk$set(echo = TRUE)


source("./R/io.R")
```


```{r, eval=F, include=F}
msigdbr::msigdbr_species()
```
```{r, eval=F, include=F}

msigdbr::msigdbr_collections()
```




```{r}
( params )
```



# load

```{r, label='load'}

if ( (!file.exists(params$volcanodir)) & 
     (!file.exists(params$rankfiledir))
){
  print("no files present")
}

```

```{r}
if (file.exists(params$rankfiledir) ){
  ( rnkfiles <- dir_ls(params$rankfiledir, pattern = ".rnk$") )
}
# rnkfile_data <- rnkfiles %>% .GlobalEnv$load_rnkfiles()

```

